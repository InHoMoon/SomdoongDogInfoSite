<?xml version="1.0" encoding="UTF-8"?>

<!-- 마이바티스 3 Mapper DTD -->
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="somdoong.notice.dao.face.NoticeDao">
	
	<select id="selectCntAll" resultType="int">
		SELECT count(*) FROM notice 
	</select>
	
	<select id="selectList" resultType="Notice" parameterType="Paging">
		SELECT * FROM (
			SELECT rownum rnum, N.* FROM (
				SELECT
					notino, adminid, title, content
					, hit, notidate
				FROM notice
				ORDER BY notino DESC
			) N
		) notice
		WHERE rnum BETWEEN #{startNo } AND #{endNo }
	</select>

	<update id="hit" parameterType="Notice">
		UPDATE notice
		SET hit = hit + 1
		WHERE notino = #{notino}
	</update>
	
	<select id="selectNotice" resultType="Notice" parameterType="Notice">
		SELECT
			notino, adminid, title , content, hit, notidate
		FROM notice
		WHERE notino = #{notino}
	</select>
	
	<insert id="insertNotice" parameterType="Notice">
		<selectKey order="BEFORE" resultType="int" keyProperty="notino">
			SELECT notice_seq.nextval FROM dual
		</selectKey>
	
		INSERT INTO notice ( notino, adminid, title , content, notidate )
		VALUES ( #{notino }, #{adminid }, #{title }, #{content }, CURRENT_TIMESTAMP )
	</insert>
	
	<update id="updateNotice" parameterType="Notice">
		UPDATE notice
		SET title = #{title}
			, content = #{content}
		WHERE notino = #{notino}
	</update>
	
	<delete id="delete" parameterType="Notice">
		DELETE notice
		WHERE notino = #{notino}	
	</delete>

</mapper>